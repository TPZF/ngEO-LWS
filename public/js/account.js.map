{"version":3,"sources":["client/js/account.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjJA;AAAA","file":"output-dev/js/account.js","sourcesContent":["var Configuration = require('configuration');\r\nvar Logger = require('logger');\r\nvar DataAccessRequestStatuses = require('account/model/dataAccessRequestStatuses');\r\nvar DownloadManagers = require('dataAccess/model/downloadManagers');\r\nvar ShopcartCollection = require('shopcart/model/shopcartCollection');\r\nvar DataAccessRequestMonitoringView = require('account/view/dataAccessRequestMonitoringView');\r\nvar DownloadManagersMonitoringView = require('account/view/downloadManagersMonitoringView');\r\nvar ShopcartManagerView = require('account/view/shopcartManagerView');\r\n// var InquiriesView = require('account/view/inquiriesView');\r\nvar UserPrefsView = require('account/view/userPrefsView');\r\nvar LayerManagerView = require('account/view/layerManagerView');\r\nvar account_template = require('../pages/account');\r\nrequire('ui/tabs');\r\n\r\n\r\n\r\n// Private variable : the different view of My Account page\t\r\nvar dmView;\r\nvar darView;\r\n// var inquiriesView;\r\nvar userPrefsView;\r\nvar shopcartManagerView;\r\n\r\nvar activeView;\r\n\r\nvar refreshViewOnResize = _.debounce(function() {\r\n\tif (activeView.refreshSize) activeView.refreshSize();\r\n}, 300);\r\n\r\n// Function call when a tab is activated\r\nvar onTabActivated = function($link) {\r\n\r\n\tswitch ($link.attr('href')) {\r\n\t\tcase \"#downloadManagersMonitoring\":\r\n\t\t\tDownloadManagers.fetch();\r\n\t\t\tactiveView = dmView;\r\n\t\t\tbreak;\r\n\t\tcase \"#DARMonitoring\":\r\n\t\t\tDataAccessRequestStatuses.fetch();\r\n\t\t\tactiveView = darView;\r\n\t\t\tbreak;\r\n\t\tcase \"#userPrefs\":\r\n\t\t\tactiveView = userPrefsView;\r\n\t\t\tbreak;\r\n\t\t// case \"#inquiries\":\r\n\t\t// \tactiveView = inquiriesView;\r\n\t\t// \tbreak;\r\n\t\tcase \"#shopcarts\":\r\n\t\t\tShopcartCollection.fetch();\r\n\t\t\tactiveView = shopcartManagerView;\r\n\t\t\tbreak;\r\n\t\tcase \"#layerManager\":\r\n\t\t\tactiveView = layerManagerView;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tif (activeView.refreshSize) activeView.refreshSize();\r\n};\r\n\r\nmodule.exports = {\r\n\r\n\t/**\r\n\t * Build the root element of the module and return it\r\n\t */\r\n\r\n\tbuildElement: function() {\r\n\t\tvar account_html = account_template(Configuration.localConfig.contextHelp);\r\n\t\tvar acc = $(account_html);\r\n\t\tacc.find('#tabs').tabs({\r\n\t\t\ttheme: \"b\",\r\n\t\t\tactivate: onTabActivated\r\n\t\t});\r\n\t\treturn acc;\r\n\t},\r\n\r\n\t/**\r\n\t * Called when the module main page is shown\r\n\t */\r\n\tshow: function() {\r\n\t\tif (activeView.refreshSize)\r\n\t\t\tactiveView.refreshSize();\r\n\t},\r\n\r\n\t/**\r\n\t * Initialize the module.\r\n\t * Called after buildElement\r\n\t */\r\n\tinitialize: function() {\r\n\r\n\t\t$(window).resize(refreshViewOnResize);\r\n\r\n\t\t// Create the download managers monitoring view\r\n\t\tdmView = new DownloadManagersMonitoringView({\r\n\t\t\tmodel: DownloadManagers,\r\n\t\t\tel: \"#downloadManagersMonitoring\"\r\n\t\t});\r\n\t\tdmView.render();\r\n\r\n\t\t// Create the view to monitor data access requests\r\n\t\tdarView = new DataAccessRequestMonitoringView({\r\n\t\t\tmodel: DataAccessRequestStatuses,\r\n\t\t\tel: \"#DARMonitoring\"\r\n\t\t});\r\n\r\n\t\t//Create the shopcart manager view \r\n\t\tshopcartManagerView = new ShopcartManagerView({\r\n\t\t\tmodel: ShopcartCollection,\r\n\t\t\tel: \"#shopcarts\"\r\n\t\t});\r\n\r\n\t\t// NGEO-1967: Replace inquiries view by \"Contact Us\" link\r\n\t\t// //Create the inquiries View\r\n\t\t// inquiriesView = new InquiriesView({\r\n\t\t// \t//model : inquiery,\r\n\t\t// \tel: \"#inquiries\"\r\n\t\t// });\r\n\t\t// inquiriesView.render();\r\n\r\n\t\t//Create the user prefs View\r\n\t\tuserPrefsView = new UserPrefsView({\r\n\t\t\tel: \"#userPrefs\"\r\n\t\t});\r\n\t\tuserPrefsView.render();\r\n\r\n\t\t//Create wms manager view\r\n\t\tlayerManagerView = new LayerManagerView({\r\n\t\t\tel: \"#layerManager\"\r\n\t\t});\r\n\t\tlayerManagerView.render();\r\n\r\n\t\t// Fetch data for DM\r\n\t\tDownloadManagers.fetch();\r\n\r\n\t\tDataAccessRequestStatuses.set({\r\n\t\t\tcollapseDAR: Configuration.data.dataAccessRequestStatuses.collapseDAR,\r\n\t\t\tcollapseProducts: Configuration.data.dataAccessRequestStatuses.collapseProducts\r\n\t\t});\r\n\r\n\t\t// Fetch DAR : maybe not needed right now\r\n\t\tDataAccessRequestStatuses.fetch();\r\n\r\n\t\t// The first active is download manager monitoring\r\n\t\tactiveView = dmView;\r\n\t}\r\n\r\n};"]}