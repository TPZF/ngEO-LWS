{"version":3,"sources":["client/js/data-services-area.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlIA;AAAA","file":"output-dev/js/data-services-area.js","sourcesContent":["var Logger = require('logger');\r\nvar UserPrefs = require('userPrefs');\r\nvar Map = require('map/map');\r\nvar SearchResultsMap = require('searchResults/map');\r\nvar SearchDSA = require('search/dsa');\r\nvar SearchResultsDSA = require('searchResults/dsa');\r\nvar ShopcartDSA = require('shopcart/dsa');\r\nvar ToolBarMap = require('map/widget/toolbarMap');\r\nvar PanelManager = require('ui/panelManager');\r\nvar StackPanel = require('ui/stackPanel');\r\nvar StatusPanel = require('ui/statusPanel');\r\nvar dsa_template = require('../pages/data-services-area');\r\nvar Configuration = require('configuration');\r\nrequire('ui/toolbar');\r\nrequire('ui/dateRangeSlider');\r\n\r\nvar panelManager;\r\nvar toolbarMap;\r\n\r\nmodule.exports = {\r\n\r\n\t/**\r\n\t * Build the root element of the module and return it\r\n\t */\r\n\tbuildElement: function() {\r\n\r\n\t\tvar dsa = $(dsa_template({\r\n\t\t\ttheme: Configuration.localConfig.theme\r\n\t\t}));\r\n\t\tdsa.find('menu[type=toolbar]').not('#bottomToolbar').toolbar();\r\n\t\tdsa.find('#bottomToolbar').toolbar({\r\n\t\t\twithNumber: true,\r\n\t\t\tlarge: true\r\n\t\t});\r\n\t\treturn dsa;\r\n\t},\r\n\r\n\t/**\r\n\t * Called when the module main page is hidden\r\n\t */\r\n\thide: function() {\r\n\t\tpanelManager.save();\r\n\t\t$('.mapPopup').hide();\r\n\t\t$('#statusBar').hide();\r\n\t\t$('#dateRangeSlider').hide();\r\n\t\t$('#searchToolbar').hide();\r\n\t\t$('#mapToolbar').hide();\r\n\t\t$('#bottomToolbar').hide();\r\n\t},\r\n\r\n\t/**\r\n\t * Called when the module main page is shown\r\n\t */\r\n\tshow: function() {\r\n\t\t$('.mapPopup').show();\r\n\t\t$('#statusBar').show();\r\n\r\n\t\tvar $dateRangeSlider = $('#dateRangeSlider');\r\n\t\tif ($dateRangeSlider.is(':ui-dateRangeSlider')) {\r\n\t\t\t$dateRangeSlider.show();\r\n\t\t\t$dateRangeSlider.dateRangeSlider('refresh');\r\n\t\t}\r\n\r\n\t\t$('#searchToolbar').show();\r\n\t\t$('#mapToolbar').show();\r\n\t\t$('#bottomToolbar').show();\r\n\t\tpanelManager.restore();\r\n\t},\r\n\r\n\t/**\r\n\t * Initialize the module.\r\n\t * Called after buildElement\r\n\t *\r\n\t * @param element The root element of the module\r\n\t */\r\n\tinitialize: function(element) {\r\n\r\n\t\t// Create the panel manager and the panel used for the different view : search, result, table...\r\n\t\tpanelManager = new PanelManager({\r\n\t\t\tel: '#mapContainer',\r\n\t\t\tcenter: '#map'\r\n\t\t});\r\n\r\n\t\t// Add left panel (use for search )\r\n\t\tpanelManager.add('left', new StackPanel({\r\n\t\t\tel: '#left-panel',\r\n\t\t\tclasses: 'ui-body-'+Configuration.localConfig.theme+' panel-content-left'\r\n\t\t}));\r\n\r\n\t\t// Add bottom panel (use for results and shopcart)\r\n\t\tpanelManager.add('bottom', new StatusPanel({\r\n\t\t\tel: '#bottom-panel',\r\n\t\t\tclasses: 'ui-body-'+Configuration.localConfig.theme+' panel-content-bottom'\r\n\t\t}));\r\n\r\n\t\t// Initialize \"pickedFeatures\"-event AFTER adding status panel\r\n\t\t// to ensure that click on map changes status depending on feature before\r\n\t\t// scrolling to highlighted feature in TableView thus the feature2row is consistent\r\n\t\tSearchResultsMap.initialize();\r\n\r\n\t\tpanelManager.on('centerResized', function() {\r\n\t\t\tMap.updateViewportSize();\r\n\t\t\t// TODO : improve that\r\n\t\t\tvar $dateRangeSlider = $('#dateRangeSlider');\r\n\t\t\tif ($dateRangeSlider.is(':ui-dateRangeSlider')) {\r\n\t\t\t\t$dateRangeSlider.dateRangeSlider('refresh');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t\t// Need to add some elements to map to have good positionning.\r\n\t\t// Not very pretty..\r\n\t\t// MS: work in progress.. commented parts should be deleted at the end..\r\n\t\t$('#statusBar')/*.appendTo('#map')*/.hide().trigger('create');\r\n\t\t// $('#dateRangeSlider').appendTo('#map').hide();\r\n\t\t// $('#searchToolbar').appendTo('#map').hide();\r\n\t\t$('#mapToolbar').appendTo('#map').hide();\r\n\t\t$('#bottomToolbar')/*.appendTo('#map')*/.hide();\r\n\r\n\t\t// Create the router\r\n\t\tvar router = new Backbone.Router();\r\n\r\n\t\t// Create all widgets for diferent modules\r\n\t\tSearchDSA.initialize(element, router, panelManager);\r\n\t\tSearchResultsDSA.initialize(element, router, panelManager);\r\n\t\tShopcartDSA.initialize(element, router, panelManager);\r\n\r\n\t\t// Initialize toolbar and context help\r\n\t\ttoolbarMap = new ToolBarMap(element);\r\n\t}\r\n};"]}